<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>resources/orders.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Account.html">Account</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#recoverUsername">recoverUsername</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#redeemCoupon">redeemCoupon</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#resetPassword">resetPassword</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#setLanguage">setLanguage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Account.html#setVacationMode">setVacationMode</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Cart.html">Cart</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#addArticle">addArticle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#checkout">checkout</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#empty">empty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#getShippingMethods">getShippingMethods</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#removeArticle">removeArticle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#setShippingAddress">setShippingAddress</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#setShippingMethod">setShippingMethod</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Cart.html#updateArticles">updateArticles</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Market.html">Market</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#findMetaproducts">findMetaproducts</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#findProducts">findProducts</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#findUsers">findUsers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getArticles">getArticles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getArticlesByUser">getArticlesByUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getExpansionSingles">getExpansionSingles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getGameExpansions">getGameExpansions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getGames">getGames</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getMetaproduct">getMetaproduct</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getProduct">getProduct</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Market.html#getUser">getUser</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Messages.html">Messages</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Messages.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Messages.html#deleteThread">deleteThread</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Messages.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Messages.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-MkmApi.MkmApi.html">MkmApi</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-MkmApi.MkmApi.html#changeUser">changeUser</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Orders.html">Orders</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#acceptCancellation">acceptCancellation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#cancel">cancel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#confirmReception">confirmReception</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#evaluate">evaluate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#getOrderById">getOrderById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#getOrders">getOrders</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#markAsSent">markAsSent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#modifyOrder">modifyOrder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#requestCancellation">requestCancellation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Orders.html#setTrackingNumber">setTrackingNumber</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Stock.html">Stock</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#add">add</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#change">change</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#dereaseAmmount">dereaseAmmount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#findArticles">findArticles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#getArticle">getArticle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#getInShoppingCart">getInShoppingCart</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stock.html#increaseAmmount">increaseAmmount</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Wants.html">Wants</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#addItems">addItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#changeName">changeName</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#createList">createList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#deleteList">deleteList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#deleteWants">deleteWants</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#editWants">editWants</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#getLists">getLists</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Wants.html#getProducts">getProducts</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-MkmApi.html">MkmApi</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">resources/orders.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Order managing functions
 */
export class Orders {
    /**
     * Main constructor
     * @private
     * @param {MkmApi} api Parent api to make the calls
     */
    constructor(api) {
        this.api = api;
    }

    /**
     * Get all the information fo a single order
     * @param  {Number}  idOrder id of the order
     * @return {Promise}         Order information
     */
    async getOrderById(idOrder) {
        return this.api.makeCall(`order/${idOrder}`);
    }

    /**
     * Modify an order (mark as sent, mark received, request cancel, aceept cancel or cancel)
     * @param  {Number}  idOrder             id of the order to be modified
     * @param  {('send'|'confirmReception'|'cancel'|'requestCancellation'|'acceptCancellation')}
     * action Action to perform on the order, possible values for action:
     * * send: can be performed by the seller, if the current state is paid
     * * confirmReception: can be performed by the buyer, if the current state is sent
     * * cancel: can be performed by the seller, if the current state is bought for more than
     * 7 days; can be performed by the buyer, if the current state is paid for more than 7 days
     * * requestCancellation: can be performed by both, if the state is not yet sent, the
     * additional key reason is required; if the seller requests cancellation, an optional key
     * relistItems can be provided to indicate, if the articles of the order should be relisted
     * after the cancellation request was accepted by the buyer
     * * acceptCancellation: can be performed by both (but must be opposing actor), if the state
     * is cancellationRequested; if the seller accepts the cancellation request, an optional key
     * relistItems can be provided to indicate, if the articles of the order should be relisted
     * thereafter
     * @param  {String}  [reason='']         Reason of the cancellation (only needed if
     * {@link action} is 'requestCancellation')
     * @param  {Boolean} [relistItems=false] Relist items after the cancellation is resolved
     * (only used if {@link action} is 'requestCancellation' or 'acceptCancellation')
     * @return {Promise} Operation result
     */
    async modifyOrder(idOrder, action, reason = '', relistItems = false) {
        const params = { action };
        if (action === 'requestCancellation') {
            params.reason = reason;
            params.relistItems = relistItems;
        }
        return this.api.makeCall(`order/${idOrder}`, 'PUT', params);
    }

    /**
     * Mark as sent an order.&lt;br>
     * It is just a shorthand to ```modifyOrder(idOrder, 'send')```
     * @param  {Number}  idOrder Order to be marked as sent
     * @return {Promise} Operation result
     */
    async markAsSent(idOrder) {
        return this.modifyOrder(idOrder, 'send');
    }

    /**
     * Confirm reception of an order.&lt;br>
     * It is just a shorthand to ```modifyOrder(idOrder, 'confirmReception')```
     * @param  {Number}  idOrder Order to be marked as received
     * @return {Promise} Operation result
     */
    async confirmReception(idOrder) {
        return this.modifyOrder(idOrder, 'confirmReception');
    }

    /**
     * Cancel an order.&lt;br>
     * It is just a shorthand to ```modifyOrder(idOrder, 'cancel')```
     * @param  {Number}  idOrder Order to be cancelled
     * @return {Promise} Operation result
     */
    async cancel(idOrder) {
        return this.modifyOrder(idOrder, 'cancel');
    }

    /**
     * Accept cancellation of a single order.&lt;br>
     * It is just a shorthand to ```modifyOrder(idOrder, 'acceptCancellation', '', relistItems)```
     * @param  {Number}  idOrder Order to be cancelled
     * @param  {Boolean} [relistItems=false] Relist items of the order after the cancellation
     * @return {Promise} Operation result
     */
    async acceptCancellation(idOrder, relistItems = false) {
        return this.modifyOrder(idOrder, 'acceptCancellation', '', relistItems);
    }

    /**
     * Accept cancellation of a single order.&lt;br>
     * It is just a shorthand to
     * ```modifyOrder(idOrder, 'requestCancellation', reason, relistItems)```
     * @param  {Number}  idOrder Order to be cancelled
     * @param  {String}  [reason='']         Reason for the cancellation
     * @param  {Boolean} [relistItems=false] Relist item after the cancellation have been resolved
     * @return {Promise} operation result
     */
    async requestCancellation(idOrder, reason = '', relistItems = false) {
        return this.modifyOrder(idOrder, 'requestCancellation', reason, relistItems);
    }

    /**
     * Sets the tracking number for an order as a seller
     * @param  {Number}  idOrder        Order to modify
     * @param  {String}  trackingNumber Tracking number
     * @return {Promise} Operation result
     */
    async setTrackingNumber(idOrder, trackingNumber) {
        return this.api.makeCall(`order/${idOrder}/tracking`, 'PUT', { trackingNumber });
    }

    /**
     * Evaluate an order.
     * Grading values are:
     * * 1: very good
     * * 2: good
     * * 3: neutral
     * * 4: bad
     * * 10: n/a
     * @param  {Number}  idOrder    Order to evaluate
     * @param  {Object}  evaluation Evaluation information
     * @param  {(1|2|3|4|10)}  [searchParams.evaluationGrade] General grade
     * @param  {(1|2|3|4|10)}  [searchParams.itemDescription] Description grading
     * @param  {(1|2|3|4|10)}  [searchParams.packaging] Packaging grading
     * @param  {(1|2|3|4|10)}  [searchParams.speed] Speed grading
     * @param  {String}  [searchParams.comment] Comment
     * @param  {String[]}  [searchParams.complaint] List of complaints. Posible values are:
     * * badCommunication
     * * incompleteShipment
     * * notFoil
     * * rudeSeller
     * * shipDamage
     * * unorderedShipment
     * * wrongEd
     * * wrongLang
     * @return {Promise} Operation result
     */
    async evaluate(idOrder, evaluation) {
        return this.api.makeCall(`order/${idOrder}/evaluation`, 'POST', evaluation);
    }

    /**
     * Get all orders done as a buyer or seller in a specific state
     * @param  {Boolean} isBuyer      Return order done as buyer, is set to false it
     * will return orders done as seller)
     * @param  {('bought'|'paid'|'sent'|'received'|'lost'|'cancelled'|Number)}  state
     * Return orders in the specified state, if sent as a number possible values are:
     * * 1: bought
     * * 2: paid
     * * 4: sent
     * * 8: received
     * * 32: lost
     * * 128: cancelled
     * @param  {Number}  [start=null] Paginate results starting with this element,
     * only 100 elements will be returned
     * @return {Promise} List of all Orders matching the filters
     */
    async getOrders(isBuyer, state, start = null) {
        const actor = isBuyer ? '2' : '1';
        return this.api.makeCall(`orders/${actor}/${state}/${start == null ? '' : start}`);
    }
}

export default Orders;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
